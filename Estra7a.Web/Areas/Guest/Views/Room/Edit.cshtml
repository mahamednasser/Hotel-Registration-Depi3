@model EditRoomViewModel
@{
    ViewBag.Title = "Edit Room";
}

<!-- Booking Section -->
<section id="booking" class="booking section">
    <div class="container" data-aos="fade-up" data-aos-delay="100">
        <div class="reservation-wrapper">
            <div class="reservation-header text-center" data-aos="fade-up" data-aos-delay="200">
                <h2>Edit Room (Not implemented yet)</h2>
                <p class="lead">Experience unmatched hospitality with our streamlined room management process</p>
            </div>

            <div class="booking-grid">
                <div class="booking-form-section" data-aos="fade-right" data-aos-delay="300">
                    <div class="form-container">

                        <!-- Main Add Room Form -->
                        <form class="reservation-form" asp-action="Create" asp-controller="Room" method="post" enctype="multipart/form-data">

                            <!-- Room Information -->
                            <div class="form-section mb-4">
                                <h4>Room Information</h4>
                                <div class="form-grid">
                                    <div class="form-group full-width mb-3">
                                        <label asp-for="Name" class="form-label"></label>
                                        <input asp-for="Name" class="form-control" required />
                                        <span asp-validation-for="Name" class="text-danger"></span>
                                    </div>

                                    <div class="form-group mb-3">
                                        <label asp-for="PricePerNight" class="form-label"></label>
                                        <input asp-for="PricePerNight" type="number" class="form-control" required />
                                        <span asp-validation-for="PricePerNight" class="text-danger"></span>
                                    </div>

                                    <div class="form-group mb-3">
                                        <label asp-for="Area" class="form-label"></label>
                                        <input asp-for="Area" type="number" class="form-control" required />
                                        <span asp-validation-for="Area" class="text-danger"></span>
                                    </div>
                                    <div class="form-group mb-3">
                                        <label asp-for="NumberOfRooms" class="form-label"></label>
                                        <input asp-for="NumberOfRooms" type="number" class="form-control" required />
                                        <span asp-validation-for="NumberOfRooms" class="text-danger"></span>
                                    </div>
                                    <div class="form-group mb-3">
                                        <label asp-for="Capacity" class="form-label"></label>
                                        <input asp-for="Capacity" type="number" class="form-control" required />
                                        <span asp-validation-for="Capacity" class="text-danger"></span>
                                    </div>
                                </div>
                            </div>

                            <!-- Room Type -->
                            <div class="form-group mb-4">
                                <label asp-for="RoomtypeId" class="form-label">Room Type</label>
                                <select asp-for="RoomtypeId" asp-items="Model?.RoomTypes" class="form-select" id="room-type" required>
                                    <option value="">Select Room Type</option>
                                </select>

                                <!-- Add Type Modal Trigger -->
                                <button type="button" class="btn btn-outline-primary mt-2" data-bs-toggle="modal" data-bs-target="#addTypeModal">
                                    <i class="bi bi-plus-circle me-1"></i> Add Type
                                </button>
                            </div>

                            <!-- Include Room Type Modal -->
                            <!-- Room Description -->
                            <div class="form-group mb-3">
                                <label asp-for="Description" class="form-label"></label>
                                <textarea asp-for="Description" class="form-control" rows="3" placeholder="Add room description or details..." required></textarea>
                                <span asp-validation-for="Description" class="text-danger"></span>
                            </div>


                           
                            <button type="button" class="btn btn-secondary mb-3" data-bs-toggle="modal" data-bs-target="#manageImagesModal">
                                Manage Images
                            </button>
                            <partial name="_ManageImagesModal" />






                            @* <!-- Room Images -->
                            <div class="form-section mb-4">
                                <h4>Room Images</h4>

                                <!-- Base Image -->
                                <div class="form-group mb-3">
                                    <label asp-for="BaseImage" class="form-label">Base Image (Cover)</label>
                                    <input asp-for="BaseImage" type="file" class="form-control" accept="image/*" required />
                                    <span asp-validation-for="BaseImage" class="text-danger"></span>
                                    <small class="text-muted">Current file: CoverImage.png</small>
                                </div>

                      


                                <!-- Additional Images -->
                                <div id="additional-images-container">
                                    <div class="form-group mb-3">
                                        <label class="form-label">Additional Image</label>
                                        <input type="file" class="form-control" name="RoomImages" accept="image/*">
                                    </div>
                                </div>

                                <button type="button" class="btn btn-outline-primary btn-sm" id="add-image-btn">
                                    <i class="bi bi-plus-circle me-1"></i> Add another image
                                </button>
                            </div>
                            *@
                            <!-- Submit -->


                            <div class="form-actions text-center">
                                <button type="submit" class="btn btn-primary">
                                    <i class="bi bi-pencil me-2"></i>
                                    Edit Room
                                </button>
                            </div> 


                        </form>
                    </div>
                </div>
            </div>
        </div>


    </div>
</section>
<partial name="_AddRoomTypeModal" model="new AddRoomTypeViewModel()" />






@section Scripts {
    <partial name="_ValidationScriptsPartial" />

    <script>

        // document.getElementById("add-image-btn").addEventListener("click", function () {
        //     const container = document.getElementById("additional-images-container");

        //     const div = document.createElement("div");
        //     div.classList.add("form-group", "mb-3");

        //     div.innerHTML = `
        //         <label class="form-label">Additional Image</label>
        //         <input type="file" class="form-control" name="RoomImages" accept="image/*">
        //     `;

        //     container.appendChild(div);
        // });




        $("#saveTypeBtn").on("click", function () {
            const form = $("#addTypeForm");

            const formData = {
                RoomTypeName: $("#RoomTypeName").val(),
                RoomTypeDescription: $("#RoomTypeDescription").val(),
            };

            $.ajax({
                url: '/RoomType/AddType',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(formData),
                success: function (response) {
                    if (response.success) {


                        $("#room-type").append(
                            `<option value="${response.id}" selected>${response.name}</option>`
                        );

                        const modal = bootstrap.Modal.getInstance(document.getElementById('addTypeModal'));
                        modal.hide();

                        // امسح الداتا
                        form[0].reset();
                    }
                },
                // error: function (xhr) {
                //     console.error(xhr.responseText);
                //     alert("❌ Something went wrong while adding the room type.");
                // }
            });
        });
    </script>
}
